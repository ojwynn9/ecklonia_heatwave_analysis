# ecklonia_heatwave_analysis
RNA-seq workflow and enrichment analysis for &lt;i>Ecklonia radiata&lt;/i> under marine heatwave treatments.

# Ecklonia radiata RNA-seq Analysis Pipeline

This repository contains the R scripts and supporting files used to process, analyse, and visualise RNA-seq data for *Ecklonia radiata*. The workflow covers all stages from raw quantification import through differential expression, GO enrichment (ORA + GSEA), QC, and final figure generation for publication.

---

## üîß R version and package requirements

This pipeline uses **R ‚â• 4.2** and Bioconductor.  
Packages are grouped below according to purpose.

### **General data handling**
ggplot2 ‚Ä¢ stringr ‚Ä¢ tidyverse ‚Ä¢ dplyr ‚Ä¢ tibble ‚Ä¢ tidyr ‚Ä¢ reshape2 ‚Ä¢ vegan ‚Ä¢ readxl ‚Ä¢ writexl ‚Ä¢ MASS ‚Ä¢ tximport ‚Ä¢ devtools ‚Ä¢ trinotateR ‚Ä¢ BiocManager

### **Quality control & exploratory analysis**
PCAtools ‚Ä¢ ggridges ‚Ä¢ gridExtra ‚Ä¢ RColorBrewer ‚Ä¢ ggpubr ‚Ä¢ cluster ‚Ä¢ NbClust ‚Ä¢ pheatmap ‚Ä¢ ComplexHeatmap ‚Ä¢ circlize ‚Ä¢ plotly ‚Ä¢ hexbin

### **Differential expression**
DESeq2 ‚Ä¢ edgeR ‚Ä¢ glmpca ‚Ä¢ apeglm ‚Ä¢ ashr ‚Ä¢ DEXSeq ‚Ä¢ vsn ‚Ä¢ VennDiagram

### **GO enrichment & pathway analysis**
goseq ‚Ä¢ fgsea ‚Ä¢ GSEABase ‚Ä¢ msigdbr ‚Ä¢ clusterProfiler ‚Ä¢ GO.db ‚Ä¢ AnnotationDbi ‚Ä¢ biomaRt

### **Plotting & figure assembly**
EnhancedVolcano ‚Ä¢ DEGreport ‚Ä¢ ggnewscale ‚Ä¢ patchwork ‚Ä¢ magick ‚Ä¢ gtable ‚Ä¢ enrichplot

### **Other utilities**
digest ‚Ä¢ rstatix ‚Ä¢ methods ‚Ä¢ rmarkdown ‚Ä¢ knitr ‚Ä¢ yaml ‚Ä¢ testthat

---

## üìÅ Input files

These files must be present in the working directory (or paths updated accordingly):

| File | Description |
|------|-------------|
| **samples.txt** | Sample metadata including treatment and replicate information. |
| **transdecoder_gene_trans_map.txt** | Transcript ‚Üí gene mapping generated by TransDecoder. |
| **go_annotations_new.txt** | GO term annotations per gene. |
| **trinotate_annotation_report_new.xls** | Full Trinotate annotation report. |

---

## üì• Reading files in R

Example imports used in the pipeline:

```r
sampleinfo.df <- read_tsv("samples.txt")

tx2gene <- read.table(
  "transdecoder_gene_trans_map.txt",
  header = FALSE,
  col.names = c("transcript_id", "gene_id")
)

go_annotations <- read_tsv(
  "go_annotations_new.txt",
  col_names = c("gene_id", "go_terms")
)

trinotate_report <- read_trinotate("trinotate_annotation_report_new.xls")
